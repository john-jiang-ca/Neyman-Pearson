% cyclostationary based energy detection
\section{Cyclostationary Detection for multiple Primary Users}
\subsection{System Model}

We consider a cognitive radio system where the spectrum can be occupied by exactly one of two distinct primary signals $\{s_A, s_B\}$ or it could be vacant. Let $H_0$ denote the situation under which the channel is free, $H_1$ denote the hypothesis under which the channel is occupied by signal $s_A$ and $H_2$ denote the hypothesis under which the channel is occupied by signals $s_B$. Both $s_A, s_B$ are OFDM signals with exactly the same data structure. The block diagram of the system is illustrated in Figure.

The measuring device observes $N$ samples of the noise version signals that could be present in the channel and output a suitable testing statistics. With this statistics, the testing device employs MENP to determine the status of the channel. The input of measuring device is
\begin{equation}
 \mathbf{x} = \begin{cases}
	\mathbf{n}\;\;\;\;\;\;&\text{when $H_0$ is true}\\
	\mathbf{n}+\mathbf{s}_A\;\;\;\;\;\;&\text{when $H_1$ is true}\\
	\mathbf{n}+\mathbf{s}_B\;\;\;\;\;\;&\text{when $H_2$ is true}\\
  \end{cases}
  \label{equ:1209a1}
\end{equation}
where 
\begin{equation}
  \begin{cases}
	&\mathbf{x} = (x_0, x_1, \cdots, x_{N_1})\\
	&\mathbf{s}_A = (s_{A0}, s_{A1}, \cdots, s_{A(N-1)})\\
	&\mathbf{s}_B = (s_{A0}, s_{B1}, \cdots, s_{B(N-1)})\\
	&\mathbf{n} = (n_{0}, n_{1}, \cdots, n_{N-1})\,.
  \end{cases}
  \label{xssn}
\end{equation}
Assume each OFDM frame contains a CP sequence of length $l_C$ followed by a data sequence of length $l_D$, so the total length of an OFDM frame is $l_0 = l_C+l_D$. In general case, when there are signal transmitting, the receiver is not synchronized to the transmitted signal (c.f. ), i.e. $s_{A0}$ ($s_{B0}$) is not the first symbol of an OFDM frame. Let $\tau$ represents the synchronization mismatch. That is, when $\tau = 0$, $s_0$ is the first symbol of an OFDM frame; when $\tau = l_C+l_D -1$, $s_0$ is the last symbol of an OFDM frame. Let $N = Kl_0$, we can see when $\tau=0$, the detector would observe $K$ complete  OFDM frames (as it is shown in Figure); otherwise, the detector would observe $K-1$ complete OFDM frame and $2$ incomplete OFDM frame (as it is shown in Figure). Like in most related literature (c.f. ), we assume  $n_i$ are i.i.d. CSCG with variance $2\sigma_n^2$, i.e. $n_i \sim \mathcal{CN}(0, 2\sigma_n^2)$. 

Let $r_i=x_ix_j^\ast$ ($j=i+l_D$), (c.f. ) shows $r_i$ exhibit cyclic property at frequency $\alpha = \frac{K}{l_0}$ ($K = \pm1, \pm2, \cdots$). In this case, we consider a single cyclic detector at frequency $\alpha = \frac{1}{l_0}$. The output of the measuring device is 
\begin{equation}
  Y = \frac{1}{N}\sum_{i=0}^{N-1} r_i\exp(-j2\pi\alpha i)\,.
  \label{cyclic_cov}
\end{equation}

By observing $y$, a realization  of $Y$, the testing device determines the status of the channel. Let $R$ and $I$  be the real  and imaginary part of $y$, i.e. $y=R+jI$. In the following, we consider the distribution of $R$ and $I$ under hypothesis $H_1$ with synchronization mismatch $\tau = \tau_0$.



 

\subsection{Numerical Results}

