% This is for chapter 3
\chapter{The ROC Surface of Modified Extended Neyman Pearson Test}
Previous chapter showed the MENP framework could achieve the largest probability of detection under any possible probability of false alarm constraints. This chapter proposes the Modified Receiver of Characters (M-ROC) surface to depict the relationship between probability of detection adn probability of false alarm constraints under MENP framework. The examples, respectively concerning the Gaussian case and Chi-Square case, will be presented after that. An analysis of the relationship between probability of detection and probability of false alarm constraints will be performed. 

\section{Modified Receiver of Characters}

The ROC surface of MENP (M-ROC) depicts the relationship between $P_d$ and $c_1, c_2, ..., c_M$. On one hand, it  illustrates the largest $P_d$ can that can be achieved under the constraints $P_{f_i} \leq c_i (i = 1, 2, ..., M)$, on the other hand, it provides the range of $\mathbf{c}$ for a given $P_d$.
Points $(P_d, c_1, c_2, ..., c_M)$ on M-ROC  surface can be divided into two types: 
\\1. Those with $[c_1, c_2, ..., c_M] \in \alpha^+$. Define this set of points as $M_0$; 
\\2. Those with $[c_1, c_2, ..., c_M] \notin \alpha^+$. Define this set of points as $M_1$. 

Obviously points in $M_0$ can be achieved by MENP (\rmnum{1}) and points in $M_1$ can  be achieved by MENP (\rmnum{2}). Next we consider a property of the M-ROC surface.

\noindent \textbf{Property 1}
\noindent \textit{
  \noindent Assume hypotheses given as:
}
\begin{equation}
\begin{split}
H_0:\;\;\;\;\;\;&X \sim f_0(x)\\
H_1:\;\;\;\;\;\;&X \sim f_1(x)\\
  &......\\
H_M:\;\;\;\;\;\;&X \sim f_M(x)
\end{split}
\end{equation}
\textit{
  define $g(x) = \frac{\sum_{i=1}^{M}k_if_i(x)}{f_0(x)}$ and let $F_i(x)$ to represent the CDF of hypothesis $H_i$ ($i = 1, ..., M$). If $g(x)$ is a monotonically increasing function of $x$ for any non-negative $k_i\;\;(i = 1, ..., M)$ and $F_i(x)$ is monotonically increasing function, then we have:}
  
\textit{(1)The region achieved by ENP test with non-negative parameters degenerates to a curve and the decision rule for $M_0$ is $x \substack{\bar{H}_0 \\ \geq \\ < \\H_0} x_0$.}

\textit{(2)For a specific false alarm constraints $P_{f_i} \leq c_i\;\;(i = 1, ..., M)$, the decision rule for MENP test is $x \substack{\bar{H}_0 \\ \geq \\ < \\H_0} x_0$, where $x_0 = \min(F_1^{-1}(c_1), ..., F_M^{-1}(c_M))$.}

\textit{(3)The expression of $P_d$, $P_{f_1}$, ..., $P_{f_M}$ can be written as}
\begin{equation}
\label{equ: chi pd}
  \begin{split}
    P_d &= \text{Pr}(X \leq x_0 | H_0) = F_0(x_0)\\
        P_{f_1} &= \text{Pr}(X \leq x_0 | H_1) = F_1(x_0)\\
        &......\\
            P_{f_M} &= \text{Pr}(X \leq x_0 | H_2) = F_M(x_0)
  \end{split}
\end{equation}

\noindent \textbf{PROOF}
According to the definition, $M_0$ is the region achieved by ENP test with $k_i \geq 0 (i=1, ..., M)$. The ENP decision rule is
\begin{equation}
\frac{\sum_{i=1}^{M}k_if_i(x)}{f_0(x)} \substack{\bar{H}_0 \\\geq\\< \\H_0}1
\end{equation}
which can be written as
\begin{equation}
\label{dec: gx}
g(x)\substack{\bar{H}_0 \\\geq\\< \\H_0}1
\end{equation}
Since $g(x)$ is a monotonically increasing function with $x$, hence $g^{-1}(x)$ exists and \eqref{dec: gx} can be written as 
\begin{equation}
\label{dec: x0}
x\substack{\bar{H}_0 \\\geq\\< \\H_0}x_0
\end{equation}
where $x_0 = g^{-1}(1)$.
Under decision rule \eqref{dec: x0}, the expression of $P_d$, $P_{f_1}$, ..., $P_{f_M}$ can be written as 
\begin{equation}
\begin{split}
\label{equ: pd under x0}
P_d &= \text{Pf}(X \leq x_0 | H_0) = F_0(x_0)\\
P_{f_1} &= \text{Pf}(X \leq x_0 | H_1) = F_1(x_0)\\
  &......\\
P_{f_M} &= \text{Pf}(X \leq x_0 | H_M) = F_M(x_0)
\end{split}
\end{equation}
where $F_0$, $F_1$, ..., $F_M$ are the CDFs of $X$ under $H_0$, $H_1$, ..., $H_M$. From \eqref{equ: pd under x0}, $P_{f_1}$ determines $x_0$ that in turn determines $P_{f_2}$, ..., $P_{f_M}$, $P_d$. Hence for a given $P_{f_1}$, there is only one corresponding $P_{f_i} (i= 1, ..., M)$. Hence the ENP ROC with $k_i \geq 0 (i = 1, ..., M)$ is a curve in this case.

From \eqref{equ: pd under x0}, \eqref{equ: problemstate} can be written as 
\begin{equation}
\begin{split}
\label{equ: constrain condition}
\max\;\;\;\; &P_d = F_0(x_0)\\
\text{s.t.}\;\;\;\;&P_{f_i} =  F_i(x_0) \leq c_i\;\;\;\;i = 1, 2, ..., M
\end{split}
\end{equation}
Since $P_d = F_0(x_0)$ is an increasing function of $x_0$, \eqref{equ: constrain condition} can be represented in following form:
\begin{equation}
\begin{split}
\label{equ: final constrain}
\max\;\;\;\; &x_0\\
\text{s.t.}\;\;\;\;&x_0 \leq F_i^{-1}(c_i)\;\;\;\;i = 1, 2, ..., M
\end{split}
\end{equation}
Hence the expression of $x_0$ can be written as
\begin{equation}
x_0 = \min(F_1^{-1}(c_1), F_2^{-1}(c_2), ..., F_M^{-1}(c_M))\,.
\end{equation}

%==================================================================================================
\typeout{}
\input{3/gaussian}

%==================================================================================================
\typeout{}
\input{3/chisquare}
